<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Use the SMITE method to calibrate coral geochemical data to an environmental variable of interest.">
<title>Perform the SMITE Method on a Coral Geochemical Dataset • SMITER</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Perform the SMITE Method on a Coral Geochemical Dataset">
<meta property="og:description" content="Use the SMITE method to calibrate coral geochemical data to an environmental variable of interest.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">SMITER</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="smiter-an-r-package-to-smite-coral">SMITER: An R Package to SMITE Coral<a class="anchor" aria-label="anchor" href="#smiter-an-r-package-to-smite-coral"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The goal of SMITER is to allow for easy access of the SMITE Method, a multivariate method for reconstructing sea surface temperature (SST) and seawater pH using coral skeletal geochemistry. You can find more details about the SMITE method in the forthcoming paper (Hughes et al., in press). In a sentence, SMITE leverages the covariance of multiple coral geochemical signals (e.g., Sr/Ca, Li/Mg) to optimize reconstruction skill. While SMITE is ready for widespread dissemination, it is also in active development. See guidelines below for contributing.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of SMITER from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"hphughescraft/SMITER"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The SMITER package comes with two primary functions: <a href="https://hphughescraft.github.io/SMITER/reference/SMITE.calib.html" class="external-link">SMITE.calib()</a> and <a href="https://hphughescraft.github.io/SMITER/reference/SMITE.recon.html" class="external-link">SMITE.recon()</a>. A typical workflow will go as follows.</p>
<div class="section level3">
<h3 id="calibration">Calibration<a class="anchor" aria-label="anchor" href="#calibration"></a>
</h3>
<p>First, you want to call the SMITER package and load your data into R. The SMITER package comes with sample data from Hughes et al. (in press) for you to work with.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Call the SMITER package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hphughescraft.github.io/SMITER/" class="external-link">SMITER</a></span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Load data (e.g., sample data from the SMITER package)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BMDA_1B_Comp</span><span class="op">)</span> <span class="co"># Data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BMDA_1B_EComp</span><span class="op">)</span> <span class="co"># Errors</span></span></code></pre></div>
<p>Next, you will want to designate a forward matrix (A), a reconstruction target (b), and the corresponding errors in both (Ae, be).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proxy_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'BCa'</span>, <span class="st">'SrCa'</span>, <span class="st">'MgCa'</span>, <span class="st">'UCa'</span>, <span class="st">'LiCa'</span>, <span class="st">'LiMg'</span>, <span class="st">'d11B'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">bmda_1b_comp</span><span class="op">[</span>,<span class="va">proxy_names</span><span class="op">]</span></span>
<span><span class="va">Ae</span> <span class="op">&lt;-</span> <span class="va">bmda_1b_ecomp</span><span class="op">[</span>,<span class="va">proxy_names</span><span class="op">]</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">bmda_1b_comp</span><span class="op">[</span>,<span class="st">'Temp'</span><span class="op">]</span></span>
<span><span class="va">be</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now you can execute a SMITE calibration.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SMITE</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SMITE.calib.html">SMITE.calib</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>, b <span class="op">=</span> <span class="va">b</span>, Ae <span class="op">=</span> <span class="va">Ae</span>, be <span class="op">=</span> <span class="va">be</span>, eigenclean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Here is a quick plot to compare the SMITE SST reconstruction to true SST using this chunk of code.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Date</span> <span class="op">&lt;-</span> <span class="va">bmda_1b_comp</span><span class="op">$</span><span class="va">Date</span></span>
<span></span>
<span><span class="co"># Base plot #</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">b</span>, type <span class="op">=</span> <span class="st">'l'</span>, ylab <span class="op">=</span> <span class="st">'SST (\u00B0C)'</span>, </span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">SMITE</span><span class="op">$</span><span class="va">recon</span><span class="op">$</span><span class="va">bhat.low</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">SMITE</span><span class="op">$</span><span class="va">recon</span><span class="op">$</span><span class="va">bhat.high</span><span class="op">)</span><span class="op">)</span></span>
<span>     <span class="op">)</span></span>
<span>     </span>
<span><span class="co"># Add SMITE reconstruction # </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">SMITE</span><span class="op">$</span><span class="va">recon</span><span class="op">$</span><span class="va">bhat.mu</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">SMITE</span><span class="op">$</span><span class="va">recon</span><span class="op">$</span><span class="va">bhat.high</span>, col <span class="op">=</span> <span class="st">'red'</span>, lt <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">SMITE</span><span class="op">$</span><span class="va">recon</span><span class="op">$</span><span class="va">bhat.low</span>, col <span class="op">=</span> <span class="st">'red'</span>, lt <span class="op">=</span> <span class="st">'dashed'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add legend #</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True SST"</span>, <span class="st">"SMITE SST"</span>, <span class="st">"95% CI"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       title <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-SMITE_SampleRecon.png"></p>
<p>Note that this function will make a few assumptions regarding your calibration. First, it will assume that the errors you provided are uncorrelated (noise = ‘white’). If your errors are correlated, set the ‘noise’ argument to ‘red’ and provide the value of the lag-1 autocorrelation coefficient in the ‘acc’ argument.</p>
<p>Second, the function uses a bootstrap Monte Carlo approach to estimate a confidence interval on your singular values (S), your model parameters (x), and your predicted values for the reconstruction target (bhat or recon). You can specify the parameters of this Monte Carlo approach through the ‘it’ and ‘alpha’ arguments. See the <a href="https://hphughescraft.github.io/SMITER/reference/SMITE.calib.html" class="external-link">SMITE.calib()</a> reference page for more details.</p>
</div>
<div class="section level3">
<h3 id="reconstruction">Reconstruction<a class="anchor" aria-label="anchor" href="#reconstruction"></a>
</h3>
<p>Finally, you can reconstruct the environmental variable (in this case, SST) using the SMITE.recon() function on the forward matrix.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reconstruction</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SMITE.recon.html">SMITE.recon</a></span><span class="op">(</span></span>
<span>  A <span class="op">=</span> <span class="va">A</span>,</span>
<span>  x <span class="op">=</span> <span class="va">SMITE</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">x.mu</span>,</span>
<span>  Amu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>,</span>
<span>  Asd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">A</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  bmu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span>,</span>
<span>  bsd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that this function does not include a bootstrap Monte Carlo error estimation (yet). At minimum, the SEP estimated during calibration can be used to provide a measure of precision in your estimates. We also recommend using the mean and standard deviation of the calibration period in particular when reconstructing environmental variables beyond the calibration period. This is to ensure that changes relative to the calibration period are accurately captured.</p>
</div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Thank you for considering contributing to this project! While I am the sole developer of this R package, your feedback, bug reports, and feature requests are greatly appreciated.</p>
<div class="section level3">
<h3 id="reporting-issues">Reporting Issues<a class="anchor" aria-label="anchor" href="#reporting-issues"></a>
</h3>
<p>If you encounter any bugs, have questions, or would like to suggest improvements, please <a href="https://github.com/hphughescraft/your-package-name/issues" class="external-link">open an issue</a> on GitHub. Provide as much detail as possible, including any error messages or steps to reproduce the issue.</p>
</div>
<div class="section level3">
<h3 id="feedback-and-feature-requests">Feedback and Feature Requests<a class="anchor" aria-label="anchor" href="#feedback-and-feature-requests"></a>
</h3>
<p>Have an idea for a new feature or improvement? Feel free to <a href="https://github.com/hphughescraft/your-package-name/issues" class="external-link">open an issue</a> to share your thoughts. I welcome feedback and ideas for making this package better.</p>
</div>
<div class="section level3">
<h3 id="getting-support">Getting Support<a class="anchor" aria-label="anchor" href="#getting-support"></a>
</h3>
<p>If you need help using the package or have general questions, please feel free to reach out to me directly via <a href="mailto:your@email.com">email</a>. I’m here to help!</p>
</div>
<div class="section level3">
<h3 id="code-modifications">Code Modifications<a class="anchor" aria-label="anchor" href="#code-modifications"></a>
</h3>
<p>As the sole developer of this project, I am responsible for maintaining and updating the codebase. While I appreciate suggestions and feedback, I kindly ask that you refrain from making direct modifications to the code on GitHub. If you have a specific feature request or bug fix that you’d like to see implemented, please open an issue to discuss it.</p>
<p>Thank you for your understanding and support!</p>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>I would like all of those who have contributed to improving the SMITE method thus far, particularly my coauthors for the SMITE methods paper (Hughes et al., in revisions). A huge thanks goes to the <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> package in R for making this method so easy to disseminate. A special thanks goes Matt Jansen for advising me in the subtleties of website design.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing SMITER</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Hunter P. Hughes <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hunter P. Hughes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
